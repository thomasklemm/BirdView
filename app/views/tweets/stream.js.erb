// stream tweets js
var conversations = '<%= j render_cached_conversation_for_tweets(@tweets) %>';

// Prepend or append tweets / conversations
<% if params[:min_id] %>
  Tweets.prependTweets(conversations);
<% else %>
  Tweets.appendTweets(conversations);
<% end %>

// Update pagination
<% if params[:max_id] %>
  <% new_pagination = @tweets.size > 0 ? j(render('tweets_pagination', tweets: @tweets)) : '' %>
  $('.pagination').replaceWith('<%= new_pagination %>');
<% end %>

// Update polling
<% new_min_id = @tweets.map(&:twitter_id).max %>
<% if new_min_id %>
  $('#tweets').attr('data-min-id', '<%= new_min_id %>');
<% end %>
